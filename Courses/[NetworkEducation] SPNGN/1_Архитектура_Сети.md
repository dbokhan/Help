# 1. Архитектура сети
В отличии от Cisco Enterprise Architecture в архитектуре провайдерских сетей больше уровней. Уровень Распределения разделяется на два.

1. Уровень Ядра (Core, backbone) - обеспечивает быструю связь между блоками (районами, регионами)

2. Уровень IP Edge - обеспечивает предоставление IP-сервисов пользователям

3. Уровень Агрегации (disctribution, aggregation) - предоставляет связность устройствам доступа, изолирует отдельные сегменты сети

4. Уровень доступа (access, edge) - реализует подключение пользователей к сети, защищает сеть от пользователей

## Core

Уровень ядра обеспечивает выскокоскоростную и надежную связность между блоками устройств других уровней:

- Максимально простой дизайн

- Резервирование всез ресурсов

Обычно реализуется с использованием IP и MPLS:

- IGP для внутренней связности (например OSPF)

- MP-BGP для пользовательской связности

- LDP для назначения меток MPLS

- Механизмы TE и QoS

## IP Edge

Уровень IP Edge - обеспечивает предоставление IP-сервисов.

Управление пользовательским трафиком:

- Услуги доступа в Интерент, VPN, телефонии, VOD/IPTV и т.д.

- QoS и ACL

- Построение туннелей L2TP, MPLS VPN, политики обработки трафика

## Aggregation

Уровень агрерации это место куда приходят вся физические каналы. Здесь же, как правило, происходит классификация/маркировка трафика.

Уровень агрегации предоставляет связность устройствам доступа и изолирует отдельные сегменты сети:

- Carrier Ethernet, ATM, TDM (т.е. не факт что на этом уровне будет использоваться Ethernet, может быть Sonet)

Два основных вариант дизайна:

- Звезда

- Кольцо

Задачи уровня агрегации:

- Классификация и маркировка трафика

- Защита сети от пользователей (IP Source Guard, storm control, и т.д.)

## Access

Уровень доступа реалиует подключение пользователей к сети:

- DSL, Ethernet, PON, мобильные базовые станции

Задачи:

- Подключения пользователей к сети

- Изоляция пользователей

- Идентификация пользовательского подключения

- Простейшая классификация трафика (например, с помощью битов в 802.1p)

- Простейшие механизмы защиты сети

## Терминология

**Network Service Provider** - обеспечивает физическую связность

**Internet Service Provider** - обеспечивает услугу доступа в Интернет:

- **Telecommunications Service Provider (TSP)** - обеспечивает услуги ТВ и телефонии

- **Internet Telephony Service Provider (ITSP)** - обеспечивает услуги IP-телефонии

- **Application Service Provider** - контент-провайдер

**Internet Exchange Point** - точки стыка между сетями

## Устройства в сети провайдера

Мы стремимся к тому, чтобы все предыдущие уровни (Access, Aggrigation) не обращали внимания на IP заголовок, по идее, BRAS должно быть первое устройство в сети, которое смотрит на IP заголовок пользоватльских пакетов. Т.е. можно сказать что от пользователя до BRAS у нас получается своебразная "труба", в этой трубе и идет учет трафика, проверка трафика на соответствие политикам и т.д. Например в реальной жизни этой трубой может быть PPPoE.

**Broadband remote access server (BRAS)** (устройство на уровне IP Edge:

- Логическая терминация пользовательского канала, AAA

- Манипуляция политиками и QoS

- Связь пользователя с предоставляемыми услугами, а также их учет

**Маршрутизаторы**:

- CE-роутер (Customer Edge - роутер, который стоит у пользователя, он может заменятся шнурков CPE)

- PE-роутер (Provider Edge - роутеры, которые граничат с уровнем IP Edge и ядром)

- P-роутер (роутеры внутри ядра, не видят пользовательский трафик в виде IP пакетов)

**Customer-premises equipment (CPE)** - определяет границу зоны ответственности, demarcation point

## Архитектура Интернета

**Пиринг** - передача трафика нам и от нас. Подразумевается, что мы будем передавать именно тот трафик, который предназначается для сети соседа.

**Uplink** - компания, которая согласна принимать наш трафик для передачи куда-то дальше. За деньги.

**Tier 1** - провайдеры, которые никому не платят за uplink (за транзит трафика в другие сети. Они дружат между собой бесплатно. AT&T, Verizon, Deutch Telekom, CenturyLink, NTT, Orange, Telefonica и т.д.

- Региональный Tier 1 оператор - пирится с другими провайдерами в пределах своего региона, но платит деньги за транзит иностранного трафика

**Tier 2** - стремится пириться бесплатно, но покумает долю транзита (Hurricane Electric, Cogent, Vodafone, China Telecom, British Telecom)

**Tier 3** - платит за значительную долю транзитного трафика

## Услуги в сети провайдера

Triple Play для физлиц:

- Доступ в Интернет

- Телефония

- ТВ

Специальные услуги для юрлиц:

- VPN

- Managed Services

Смежные услуги:

- Видеонаблюдения

- Сигнализация

Дополнительные плющки у крупных провайдеров:

- Скидки на мобильную связь

